<!DOCTYPE html>
<html>
<head>
	<script type="text/javascript" src="http://cdn.echoenabled.com/sdk/v3/dev/loader.js"></script>
	<style type="text/css">
		#composer, #stream { width: 440px; margin: 0px auto 10px auto; }
	</style>
</head>
<body>

<div id="composer"></div>
<div id="stream"></div>

<script type="text/javascript">
	Echo.Loader.initApplication({
		"script": "{%=baseURL%}/streamserver.pack.js",
		"component": "Echo.StreamServer.Controls.SubmitComposer",
		"backplane": {
			"serverBaseURL": "https://api.echoenabled.com/v1",
			"busName": "jskit"
		},
		"config": {
			"target": document.getElementById("composer"),
			"appkey": "echo.jssdk.demo.aboutecho.com",
			"requestMethod": "POST",
			"targetURL": "http://example.com/lizard/composer",
			"infoMessages": {"enabled": false},
			"confirmation": {
				"enabled": false
			},
			//"auth": this.config.get("auth"),
			"submitPermissions": "allowGuest",
			"plugins": [{
			//	"name": "PhotoComposer"
			//}, {
				"name": "LinkComposer"
			}, {
				"name": "JanrainBackplaneHandler",
				"appId": "echo"
			}]
		}
	});
	Echo.Loader.initApplication({
		"script": "//cdn.echoenabled.com/sdk/v3/dev/streamserver.pack.js",
		"component": "Echo.StreamServer.Controls.Stream",
		"backplane": {
			"serverBaseURL": "https://api.echoenabled.com/v1",
			"busName": "jskit"
		},
		"config": {
			"target": document.getElementById("stream"),
			"query": "childrenof:http://example.com/lizard/composer safeHTML:permissive itemsPerPage:5 -state:ModeratorDeleted children:2 -state:ModeratorDeleted",
			"appkey": "echo.jssdk.demo.aboutecho.com",
			"liveUpdates": {"transport": "websockets"},
			"item": {
				"reTag": false,
				"buttonsOrder": ["Reply", "Edit", "Moderation.Delete"]
			},
			"plugins": [{
				"name": "Reply",
				"requestMethod": "POST",
				"submitPermissions": "allowGuest",
				"nestedPlugins": [{
				//	"name": "PhotoComposer"
				//}, {
					"name": "LinkComposer"
				}, {
					"name": "JanrainBackplaneHandler",
					"appId": "echo"
				}]
			}, {
				"name": "Edit",
				"requestMethod": "POST",
				"submitPermissions": "allowGuest",
				"nestedPlugins": [{
					"name": "PhotoComposer"
				}, {
					"name": "LinkComposer"
				}, {
					"name": "JanrainBackplaneHandler",
					"appId": "echo"
				}]
			}, {
				"name": "Moderation"
			}]
		}
	});
</script>

</body>
</html>
